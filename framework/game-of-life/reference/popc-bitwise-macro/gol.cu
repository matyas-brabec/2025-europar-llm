#include "gol.cuh"
#include <cuda_runtime.h>
#include <iostream>

#define INDEX(x, y, dim) ((y) * (dim) + (x))
#define WORD_TYPE uint64_t

#define POPCOUNT_64(x) __popcll(x)
#define GOL_COMPUTE_ROWED(lt, ct, rt, lc, cc, rc, lb, cb, rb) (((((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1)))) == (static_cast<std::uint64_t>(0b1)))) | (POPCOUNT_64(((((lc & static_cast<std::uint64_t>(0b11)) << 7)) | (((cc & static_cast<std::uint64_t>(0b10)) << 5)) | (((rc & static_cast<std::uint64_t>(0b11)) << 3)) | (((lt & static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000000)) >> 2)) | (((ct & static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000000)) >> 1)) | (rt & static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000000))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64(((((lc & static_cast<std::uint64_t>(0b1100000000000000000000000000000000000000000000000000000000000000)) >> 7)) | (((cc & static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000000000)) >> 5)) | (((rc & static_cast<std::uint64_t>(0b1100000000000000000000000000000000000000000000000000000000000000)) >> 3)) | (((lb & static_cast<std::uint64_t>(0b1)) << 2)) | (((cb & static_cast<std::uint64_t>(0b1)) << 1)) | (rb & static_cast<std::uint64_t>(0b1))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10)))) == (static_cast<std::uint64_t>(0b10)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111)))) << (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101)))) << (3)) | ((lc) & (static_cast<std::uint64_t>(0b111)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100)))) == (static_cast<std::uint64_t>(0b100)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110)))) << (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010)))) << (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000)))) == (static_cast<std::uint64_t>(0b1000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100)))) << (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100)))) << (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000)))) == (static_cast<std::uint64_t>(0b10000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000)))) << (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000)))) << (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000)))) == (static_cast<std::uint64_t>(0b100000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000)))) << (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000)))) << (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000)))) == (static_cast<std::uint64_t>(0b1000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000)))) << (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000)))) << (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000)))) == (static_cast<std::uint64_t>(0b10000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000)))) == (static_cast<std::uint64_t>(0b100000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000)))) == (static_cast<std::uint64_t>(0b1000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000)))) == (static_cast<std::uint64_t>(0b10000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000)))) == (static_cast<std::uint64_t>(0b100000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b10100000000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b11100000000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b1000000000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b101000000000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b111000000000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b10000000000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))|(((static_cast<std::uint64_t>(((((((((cc) & (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000000000)))) == (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000000000)))) | (POPCOUNT_64((((((rc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000000000000)))) >> (6)) | ((((cc) & (static_cast<std::uint64_t>(0b1010000000000000000000000000000000000000000000000000000000000000)))) >> (3)) | ((lc) & (static_cast<std::uint64_t>(0b1110000000000000000000000000000000000000000000000000000000000000)))))))) == (3)))) ? (static_cast<std::uint64_t>(0b100000000000000000000000000000000000000000000000000000000000000)) : (static_cast<std::uint64_t>(0b0))))))))

__device__ WORD_TYPE load_word(const WORD_TYPE* input, int x_word, int y_word, int x_dim, int y_dim) {
    if (x_word < 0 || x_word >= x_dim || y_word < 0 || y_word >= y_dim) {
        return 0;
    }
    return input[y_word * x_dim + x_word];
}

__global__ void gol_kernel(const WORD_TYPE* input, WORD_TYPE* output, int dim) {

    int x = blockIdx.x * blockDim.x + threadIdx.x;
    int y = blockIdx.y * blockDim.y + threadIdx.y;

    int x_dim = dim / (sizeof(uint64_t) * 8);
    
    if (x >= x_dim || y >= dim) return;

    WORD_TYPE tl, tc, tr;
    WORD_TYPE cl, cc, cr;
    WORD_TYPE bl, bc, br;

    tl = load_word(input, x - 1, y - 1, x_dim, dim);
    tc = load_word(input, x,     y - 1, x_dim, dim);
    tr = load_word(input, x + 1, y - 1, x_dim, dim);
    cl = load_word(input, x - 1, y,     x_dim, dim);
    cc = load_word(input, x,     y,     x_dim, dim);
    cr = load_word(input, x + 1, y,     x_dim, dim);
    bl = load_word(input, x - 1, y + 1, x_dim, dim);
    bc = load_word(input, x,     y + 1, x_dim, dim);
    br = load_word(input, x + 1, y + 1, x_dim, dim);

    // WARNING: macro is implemented for columns not rows
    //   ==> we need to transpose the input
    WORD_TYPE result = GOL_COMPUTE_ROWED(
        tl, cl, bl,
        tc, cc, bc,
        tr, cr, br);

    output[y * x_dim + x] = result;
}

void run_game_of_life(const std::uint64_t* input, std::uint64_t* output, int grid_dimensions) {
    int x_dim = grid_dimensions / (sizeof(uint64_t) * 8);
    int y_dim = grid_dimensions;

    dim3 blockSize(32, 8);
    dim3 gridSize((x_dim + blockSize.x - 1) / blockSize.x, (y_dim + blockSize.y - 1) / blockSize.y);

    gol_kernel<<<gridSize, blockSize>>>(input, output, grid_dimensions);
}

void run_game_of_life(const bool* input, bool* output, int grid_dimensions) {
    (void) input;
    (void) output;
    (void) grid_dimensions;
}

void initialize_internal_data_structures(int grid_dimensions) {
    (void)grid_dimensions;
}

// MEMORY_LAYOUT: ROWS